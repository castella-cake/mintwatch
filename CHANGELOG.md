# Change Log

All notable changes to this project will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),
and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

## 0.8.0 - 2025/06

### Added
- 「カスタムのコメント透明度」機能を追加しました [#22](https://github.com/castella-cake/mintwatch/issues/22)
- 歌詞表示機能を追加しました [#16](https://github.com/castella-cake/mintwatch/issues/16)
- コメントソート機能を追加しました [#17](https://github.com/castella-cake/mintwatch/issues/17)   
  「自分のコメントのみ表示」はこれに伴いメニューに移動されています。
- 動画移動時に自動でページ最上部にスクロールするようになりました [#23](https://github.com/castella-cake/mintwatch/issues/23)
  詳細設定から自動スクロール位置をプレイヤーの位置に設定したり、無効化することができます。
- フッターとRe:将棋盤にPAGE TOPボタンを追加しました [#21](https://github.com/castella-cake/mintwatch/issues/21)
- 共有アクションで動画へのリンクをコピーできるようになりました

### Changed
- Tanstack Queryを使用したデータフェッチにほとんど移行しました [#14](https://github.com/castella-cake/mintwatch/issues/14)
- プレイヤー設定が「基本」と「コメント」に分割されました [#12](https://github.com/castella-cake/mintwatch/issues/12)
- コメントリストの仮想化により、コメントの多い長尺動画でのパフォーマンスが大幅に向上しました
- 一部の文章をよりわかりやすく変更しました
- 動画情報周りのスタイルを変更し、情報表示が詰まりすぎないように調整しました
- コンテンツツリーに新視聴と同様のリンクを追加しました(自分の動画を追加,コモンズで見る)
- コンテンツツリーの要素IDやクラス名がよりわかりやすく変更されました

### Fixed
- シークバーの要素が場合によってはみ出す問題を修正しました [#20](https://github.com/castella-cake/mintwatch/issues/20)
- プレイリストクエリのソート順が反映されない問題を修正しました
- エンドカードのシリーズ表示が常に「前の動画」として表示される問題を修正しました
- Re:将棋盤でチャンネルへのリンクが機能しない問題を修正しました
- プレミアム限定動画の表示が正しくなりました
- 最新のChrome環境でCJK文字とラテン文字の組み合わせに空白が入る問題を修正しました
- 動画の最終地点で一時停止している場合にコメントを投稿すると、先頭から再生される問題を修正しました
- スタッカーの上部にある境界線が正しく表示されるようになりました
- 一部の型付けを実態に即したものに変更しました

## 0.7.0 - 2025/05/04

### Added
- 未レンタルの PPV 動画を開いた場合に、dアニメストアニコニコ支店へのリンクを表示するようになりました [#8](https://github.com/castella-cake/mintwatch/issues/8)
- `全体的なページのスタイル` 設定でUIの密度を調整できるようになりました
- `コメントリストの表示` 設定でRe:turn以降のコメントリスト表示に切り替えられるようになりました
- NGコメント設定ができるようになりました [#7](https://github.com/castella-cake/mintwatch/issues/7)
- 公式アニメを見ている場合は、エンドカードでエピソードを表示するようになりました
- 連続再生の設定が再生キューからできるようになりました   
この変更に伴い、`連続再生`の`常に`設定は`連続再生におすすめを含める`に分離されます。
また、連続再生の設定がデフォルトにリセットされます。(デフォルトは連続再生ON、おすすめを含めるはOFFになっています)
- 「ギフト」のポップアップを開くボタンを追加しました
- 「GINZA+」プレイヤーテーマを追加しました

### Changed
- ニコるボタンにニコるっぽいアイコンが表示されるようになりました
- watch-container要素の属性にすべて`data-`プレフィックスが付与されるようになりました   
既存のUserStyleに改修が必要になる可能性があります。
- 再生不可画面の表記が変更されました
- ニコニ広告ボタンのテキストはスペースを節約するために削除されました
- デフォルトのプレイヤーデザインをリフレッシュしました   
元のプレイヤーデザインは引き続き「クラシック」から利用できます。
- ページ内のドキュメント表示を改善しました
- Shinjuku レイアウトのコメントリスト表示が少し正確になりました

### Fixed
- シアタービューの動画タイトル表記の位置が場合によってはずれる問題を修正しました
- チャンネル動画を共有するとオーナーが正しく表示されない問題を修正しました
- 3カラムの表示を一部修正しました [#9](https://github.com/castella-cake/mintwatch/issues/9)
- 稀にページの置き換えに失敗する問題を修正しました
- ルーター内でページを行き来する際に最上部へスクロールするようになりました
- フォロー新着の日別表示がタイムゾーンを考慮しない問題を修正しました
- フォント指定にNoto Sans JPを含めるようになりました

## 0.6.2 - 2025/04/23

### Changed
- 内部のAPI呼び出し関数にJSDocでの注釈を追加しました
- 一部のbody引数の型をオブジェクトに変更しました
- コメント描画の解像度はデフォルトで 1366x768 に変更されました   
  元の 1920x1080 に戻す場合は、プレイヤー設定で `高解像度でコメントを描画` を有効にします。
- video 要素の currentTime の更新間隔がフレームレートより低い場合に、自動で補完して描画するようになりました (Fixes [#5](https://github.com/castella-cake/mintwatch/issues/5))   
  これにより、Firefox 環境でのコメント描画フレームレートが大幅に改善します。無効化するにはプレイヤー設定で `コメントの補完描画` を無効にします。
- Re:将棋盤 のカスタムランキングレーンの幅を少し拡大しました

### Fixed
- PiPでのコメント描画が場合によっては一時停止される問題を修正しました
- ランキングページの置き換え機能が使用されていない場合に置き換えが機能しない問題を修正しました
- スクリプトのブロックが外部HLS プラグインの実行前に実行されるようになりました
- 未ログイン時にヘッダーコンポーネントがエラーを発生する問題を修正しました

## 0.6.1 - 2025/04/21

### Fixed
- 外部 HLS プラグインが動画クオリティを正しく送信しない場合がある問題を修正しました
- ナビゲーションバーの更新情報は視聴ページ以外で表示されないようになりました
- ブラウザーがライトモードに設定されている場合に設定ページの文字色が一部正しくない問題を修正しました

## 0.6.0 - 2025/04/20

### Added
- ナビゲーションバーとサイドメニューを追加しました
- ヘッダー固定を追加しました
- 実験的: ランキングページの置き換え機能を実装しました

### Changed
- 動画アクションのデザインを変更しました
- 再生キューへのD&Dがスマートになりました
- ヘッダーアクションの表示方法をカスタマイズできるようになりました
- プレイヤーコントローラーの統合表示時にVEFXとプレイヤー設定の表示が正しくリサイズされるようになりました
- デフォルトのパレットを微調整しました
- 一部の文章をよりわかりやすく改善しました

### Fixed
- 新ランキングページからの視聴ページ置き換えが正しく機能しない問題を緩和しました
- 一部のスタイルを調整・修正しました
- フォロー中の表示が別の動画に移動した際に正しく反映されない問題を修正しました
- 依存関係を更新しました

## 0.5.1 - 2025/04/01

### Added
- バージョン情報をより確認しやすい場所に追加しました

### Changed
- ドラッグアンドドロップの表示がよりわかりやすくなりました
- エラー表示を変更し、デバッグを容易にしました

### Fixed
- React 19への更新に合わせてコードを修正しました
- フォロー新着を表示した場合に横スクロール変換が適用されない問題を修正しました
- 横スクロール変換が正しく必要な時にスルーされない問題を緩和しました
- 一部のレンダーエラーを動画要素のrefを正しく初期化することで修正しました
- Shinjuku プレイヤーコントローラーと外部HLSプラグインを使用した場合に、画質セレクターが正しい位置に配置されるようになりました
- 音量スライダーが Firefox 環境でも正しく表示されるようになりました
- 動画の再生に失敗した場合のエラーが正しく表示されない問題を修正しました
- ストーリーボードが利用できない動画に移動してもストーリーボードがクリーンアップされない問題を修正しました
- おすすめのセレクターが正しくオーバーフローするようになりました

## 0.5.0 - 2025/03/24

### Added
- シークバーをホバーするとストーリーボードが表示されるようになりました
- 過去ログローダーを追加しました
- 詳細設定を追加しました    
- - `貢献画面をミュート` を追加しました
- - 音量ジェスチャーの変更値をカスタマイズ可能になりました
- ハイパス/ローパスフィルターを追加しました
- ヘッダーにお知らせ、マイメニュー画面を追加しました
- いいね！へのお礼メッセージがコピーできるようになりました
- Github Actions による開発ビルドが利用可能になりました
- ショートカットやジェスチャーの実行時にメッセージが表示されるようになりました
- ユーザーのフォローボタンを追加しました
- タグ編集機能を実装しました

### Changed
- 内部のState/Contextがリファクタリングされました
- プラグインのイベント仕様が大幅に変更されました    
これにより、0.4.0以前に設計されたプラグインは動作しません。    
プラグインは新しいイベント仕様に合わせて更新する必要があります。
- 動画読み込み画面にタイトル・ジャンル・オーナー情報が表示されるようになりました
- 横並びのおすすめ動画で縦スクロールが横スクロールに変換されるようになりました
- コメントリストに受信済みのコメント数が表示されるようになりました
- ヘッダー幅が1024px基準に再調整されました
- おすすめのセレクターの並び順が再調整されました
- パッケージマネージャーを PNPM に移行しました
- プレイヤー関連のアトリビュートが変更されました
- プレイリストのアイテム削除は削除モードに移行してから行うようになりました
- 画面幅が小さい場合にフレックスレイアウトにフォールバックするようになりました    
  (詳細設定から `画面幅に応じたグリッド表示のフォールバックを無効化` をオンにすると無効化します)
- Shinjuku レイアウトのシリーズ表示位置を他のレイアウトと同じ位置に移動しました
- モーダルの外側をクリックしてモーダルを閉じることができるようになりました
- プロジェクトが完全に TypeScript に移行しました
- フルスクリーンの`サイドバーを展開`を`シアタービュー`に改名し、表示を変更しました

### Fixed
- コンテンツツリーの高さによってシリーズの表示が見切れる場合がある問題を修正しました
- Chrome 環境においてヘッダーボタン, 動画アクションボタンが見た目よりもクリック可能なエリアが狭い問題を修正しました
- ツールチップが少しのホバーで表示されたり消えたりする問題を修正しました
- 特定の画面サイズでのフルスクリーンでコメントの描画位置がズレる問題を修正しました
- タイムラインが特定の条件でまだ引き伸ばされる問題を修正しました
- 音量とエフェクターのレスポンスが向上しました
- Shinjuku レイアウトのコメント送信ボタンのホバースタイルを修正しました
- 外部からの音量操作が正しくUIに反映されない問題を修正しました
- ツールチップのボーダー色が固定されました
- 登録されているシリーズがない場合のタイルのパディングを修正しました
- Stacked レイアウトの動画情報表示を改善しました
- Shinjuku レイアウトの一部コンポーネントにキーが正しく設定されていない問題を修正しました
- Shinjuku レイアウトのいいね！へのお礼メッセージに設定されたスタイルを修正しました
- ヘッダー幅を画面幅に応じて調整するようになりました
- プレイリストが正しくシリーズ付き動画などへの移動に対応しない問題を修正しました
- ライトパレット環境下でシアタービューを開始した場合に発生するスタイルの問題を修正しました
- Shinjuku レイアウトでシアタービューを開始した場合に発生するレイアウトの問題を修正しました
- 動画情報の統計表示が再調整されました
- 前の動画/次の動画がない場合にプレイヤーボタンで操作を行うとエラーが発生する問題を修正しました

## 0.4.0 - 2025/02/22

### Added
- 再生キューからアイテムを削除することができるようになりました
- 動画統計からラウドネスノーマライズ情報が確認できるようになりました
- コメントリストで「自分のコメントを表示」が使えるようになりました

### Changed
- 一般会員でも「ニコる」が使えるようになりました
- スタッカーヘッダーのボタンの状態がよりわかりやすくなりました

### Fixed
- タイムラインが特定の条件で引き伸ばされる問題を修正しました
- プレイリストの自動再生に関する問題を修正しました
- エフェクト設定に正しい単位が使われるようになりました   
- 言語設定が日本語以外に設定されている場合に発生するエラーを修正しました


## 0.3.0 - 2025/02/13

### Added
- 動画のロード中表示を追加
- Re:Re:仮 レイアウトを追加
- レコメンドに「投稿動画」と「タイムライン」が追加
- 音量調整ジェスチャーを追加(仮段階)

### Changed
- 設定画面のスタイルを変更

### Fixed
- CLSの大幅な改善
- スクリプトの実行阻止が、回線速度によっては失敗してリロードループする問題を修正
- PepperMint+ から引き継いだ時に残っていた文字列を修正
- 一部の条件において、一時停止していた動画が再び再生されてしまう問題を修正
- Shinjuku レイアウトのコンテンツツリーにパディングが適用されていない問題を修正
- Shinjuku プレイヤーのシークバーを修正
- Shinjuku レイアウトのカウンターが Firefox 環境で崩れる場合がある問題を修正

## 0.2.0 - 2025/01/25

### Added
- 初版   
PepperMint+ の v3.0.0 ブランチから引き継ぎました